*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        01/01/1999           SVSAFTXT.MPR             11:31:39  
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Development Team                                        
*                                                                
*        Copyright (C) 1999 ProMatrix Corporation                
*        5225 Ehrlich Rd., Suite C                               
*        Tampa, FL  33624                                        
*                                                                
*        Description:                                            
*        This PROGRAM was automatically generated BY GENMENU.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                               Setup Code                       
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

PARAMETER stoActiveControl,stoActiveForm

******************************************

** Menu Builder Enhancements by GENMENUX 3.0a  **

** This file has been modified using
**   GENMENUX 3.0a   - FoxPro Menu Processor **

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                             Menu Definition                    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

DEFINE POPUP textbox SHORTCUT RELATIVE FROM MROW(),MCOL()
DEFINE BAR 1 OF textbox PROMPT "\<Help - Field Description"
DEFINE BAR 2 OF textbox PROMPT "\-"
DEFINE BAR 3 OF textbox PROMPT "\<Add New" ;
	SKIP FOR TYPE('stoActiveControl.cFKUpdate_Form') = 'U' OR EMPTY(stoActiveControl.cFKUpdate_Form) OR ATC('.T.',ON('KEY','F3')) = 0
DEFINE BAR 4 OF textbox PROMPT "\<Edit" ;
	SKIP FOR TYPE('stoActiveControl.cFKUpdate_Form') = 'U' OR EMPTY(stoActiveControl.cFKUpdate_Form) OR ATC('.T.',ON('KEY','F3')) = 0
DEFINE BAR 5 OF textbox PROMPT "\<Picklist" ;
	SKIP FOR TYPE('stoActiveControl.lPicklist') = 'U' OR NOT stoActiveControl.lPicklist
ON SELECTION BAR 1 OF textbox KEYBOARD '{F3}'
ON SELECTION BAR 3 OF textbox ;
	DO _s1a0oph5w ;
	IN LOCFILE("VSA5\SVSAFTXT" ,"MPX;MPR|FXP;PRG" ,"WHERE is SVSAFTXT?")
ON SELECTION BAR 4 OF textbox ;
	DO _s1a0oph5z ;
	IN LOCFILE("VSA5\SVSAFTXT" ,"MPX;MPR|FXP;PRG" ,"WHERE is SVSAFTXT?")
ON SELECTION BAR 5 OF textbox KEYBOARD '{F2}'


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                        Cleanup Code & Procedures               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*



IF NOT (&sgcFCT('SEC_MENU','M','1','4'))
   RELEASE PAD _s1a0oph1w OF _MSYSMENU
ENDIF


IF NOT (&sgcFCT('SEC_MENU','M','2','4'))
   RELEASE BAR 1 OF Textbox
ENDIF


IF NOT (&sgcFCT('SEC_MENU','M','4','4'))
   RELEASE BAR 2 OF Textbox
ENDIF


IF NOT (&sgcFCT('SEC_MENU','M','3','4'))
   RELEASE BAR 3 OF Textbox
ENDIF


IF NOT (&sgcFCT('SEC_MENU','M','6','4'))
   RELEASE BAR 4 OF Textbox
ENDIF


IF NOT (&sgcFCT('SEC_MENU','M','5','4'))
   RELEASE BAR 5 OF Textbox
ENDIF
ACTIVATE POPUP textbox

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _S1A0OPH5W  ON SELECTION BAR 3 OF POPUP textbox         
*                                                                
*        Procedure Origin:                                       
*                                                                
*        From Menu:  SVSAFTXT.MPR,            Record:    7       
*        Called By:  ON SELECTION BAR 3 OF POPUP textbox         
*        Prompt:     Add New                                     
*        Snippet:    1                                           
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
PROCEDURE _s1a0oph5w
* Run the form that allows the user to edit the active control's
* lookup table.  The name of the form to run comes from the
* control's cFKUpdate_Form property.  The form will come up on
* a new blank record.  If the active control's lFKUpdateOneAdd
* property is set to .T., only that one new record can be added.
* Otherwise, the user can continue to edit the lookup table
* after that first new record is either saved or cancelled.

LOCAL sloForm

* When returning to the calling form, prevent the message
* from displaying that notifies the user that before leaving
* the form, changes were made but not saved.
stoActiveForm.lMessageOnReactivation_NotThisTime = .T.

* Run the form without showing/activating it.
DO FORM (stoActiveControl.cFKUpdate_Form) NAME sloForm NOSHOW

* Set the form's properties that will cause it to behave as
* described above.
sloForm.lStartWithAdd = .T.
sloForm.lStartWithAddMessage = .F.
sloForm.lFKUpdate = .T.
IF TYPE('stoActiveControl.lFKUpdateOneAdd') <> 'U'
   sloForm.lFKUpdateOneAdd = stoActiveControl.lFKUpdateOneAdd
ENDIF

* Show/activate the form and make it modal.
sloForm.Show(1)



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _S1A0OPH5Z  ON SELECTION BAR 4 OF POPUP textbox         
*                                                                
*        Procedure Origin:                                       
*                                                                
*        From Menu:  SVSAFTXT.MPR,            Record:    8       
*        Called By:  ON SELECTION BAR 4 OF POPUP textbox         
*        Prompt:     Edit                                        
*        Snippet:    2                                           
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
PROCEDURE _s1a0oph5z
* Run the form that allows the user to edit the active control's
* lookup table.  The name of the form to run comes from the
* control's cFKUpdate_Form property.

LOCAL sloForm

* When returning to the calling form, prevent the message
* from displaying that notifies the user that before leaving
* the form, changes were made but not saved.
stoActiveForm.lMessageOnReactivation_NotThisTime = .T.

* Run the form without showing/activating it.
DO FORM (stoActiveControl.cFKUpdate_Form) NAME sloForm NOSHOW

* Show/activate the form and make it modal.
sloForm.Show(1)

